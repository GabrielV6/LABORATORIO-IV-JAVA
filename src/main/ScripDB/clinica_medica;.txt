CREATE DATABASE clinica_medica;

USE clinica_medica;

CREATE TABLE `especialidades` (
  `IdEspecialidad` int NOT NULL AUTO_INCREMENT,
  `Descripcion` varchar(50) NOT NULL,
  `Estado` bit(1) NOT NULL,
  PRIMARY KEY (`IdEspecialidad`)
);

CREATE TABLE `jornadas` (
  `IdJornada` int NOT NULL AUTO_INCREMENT,
  `Descripcion` varchar(50) NOT NULL,
  `Estado` bit(1) NOT NULL,
  `Inicio` int NOT NULL,
  `Fin` int NOT NULL,
  PRIMARY KEY (`IdJornada`),
  UNIQUE KEY `UK_JornadaInicioFin` (`IdJornada`,`Inicio`,`Fin`)
);

CREATE TABLE `provincias` (
  `IdProvincia` int NOT NULL AUTO_INCREMENT,
  `Provincia` varchar(50) NOT NULL,
  PRIMARY KEY (`IdProvincia`)
);

CREATE TABLE `localidades` (
  `IdLocalidad` int NOT NULL AUTO_INCREMENT,
  `Localidad` varchar(50) NOT NULL,
  `IdProvincia` int NOT NULL,
  PRIMARY KEY (`IdLocalidad`),
  KEY `FK_ProvinciasLocalidades` (`IdProvincia`),
  CONSTRAINT `FK_ProvinciasLocalidades` FOREIGN KEY (`IdProvincia`) REFERENCES `provincias` (`IdProvincia`)
);

CREATE TABLE `nacionalidades` (
  `IdNacionalidad` int NOT NULL AUTO_INCREMENT,
  `Nacionalidad` varchar(50) NOT NULL,
  PRIMARY KEY (`IdNacionalidad`)
);

CREATE TABLE `pacientes` (
  `Id` int NOT NULL AUTO_INCREMENT,
  `Dni` varchar(10) NOT NULL,
  `Nombre` varchar(50) NOT NULL,
  `Apellido` varchar(50) NOT NULL,
  `Sexo` varchar(20) NOT NULL,
  `IdNacionalidad` int NOT NULL,
  `FechaNacimiento` datetime NOT NULL,
  `Direccion` varchar(50) NOT NULL,
  `IdProvincia` int NOT NULL,
  `IdLocalidad` int NOT NULL,
  `CorreoElectronico` varchar(50) NOT NULL,
  `Telefono` varchar(50) NOT NULL,
  `Estado` bit(1) NOT NULL,
  PRIMARY KEY (`Id`),
  KEY `FK_PacienteNacionalidad` (`IdNacionalidad`),
  KEY `FK_PacienteLocalidad` (`IdLocalidad`),
  CONSTRAINT `FK_PacienteLocalidad` FOREIGN KEY (`IdLocalidad`) REFERENCES `localidades` (`IdLocalidad`),
  CONSTRAINT `FK_PacienteNacionalidad` FOREIGN KEY (`IdNacionalidad`) REFERENCES `nacionalidades` (`IdNacionalidad`)
);

CREATE TABLE `medicosespecialidades` (
  `IdMedico` int NOT NULL,
  `IdEspecialidad` int NOT NULL,
  `Estado` bit(1) DEFAULT NULL,
  PRIMARY KEY (`IdMedico`,`IdEspecialidad`),
  KEY `FK_MedicoIdEspecialidad` (`IdEspecialidad`),
  CONSTRAINT `FK_MedicoIdEspecialidad` FOREIGN KEY (`IdEspecialidad`) REFERENCES `especialidades` (`IdEspecialidad`)
);

CREATE TABLE `perfiles` (
  `IdPerfil` int NOT NULL AUTO_INCREMENT,
  `Descripcion` varchar(50) NOT NULL,
  `Estado` bit(1) NOT NULL,
  PRIMARY KEY (`IdPerfil`)
);



CREATE TABLE `usuarios` (
  `IdUsuario` int NOT NULL AUTO_INCREMENT,
  `UserLogin` varchar(50) NOT NULL,
  `Password` varchar(50) NOT NULL,
  `IdPerfil` int NOT NULL,
  PRIMARY KEY (`IdUsuario`),
  KEY `FK_UsuarioPerfil` (`IdPerfil`),
  CONSTRAINT `FK_UsuarioPerfil` FOREIGN KEY (`IdPerfil`) REFERENCES `perfiles` (`IdPerfil`)
);

CREATE TABLE `medicos` (
  `Id` int NOT NULL AUTO_INCREMENT,
  `IdPerfil` int DEFAULT NULL,
  `Dni` varchar(10) DEFAULT NULL,
  `Nombre` varchar(50) NOT NULL,
  `Apellido` varchar(50) NOT NULL,
  `Sexo` varchar(20) DEFAULT NULL,
  `Nacionalidad` varchar(50) DEFAULT NULL,
  `FechaNacimiento` datetime NOT NULL,
  `Direccion` varchar(50) DEFAULT NULL,
  `Localidad` varchar(50) DEFAULT NULL,
  `Provincia` varchar(50) DEFAULT NULL,
  `CorreoElectronico` varchar(50) DEFAULT NULL,
  `Telefono` varchar(50) DEFAULT NULL,
  `IdJornada` int NOT NULL,
  `Estado` bit(1) NOT NULL,
  PRIMARY KEY (`Id`),
  KEY `FK_MedicoPerfil` (`IdPerfil`),
  KEY `FK_MedicoIdJornada` (`IdJornada`),
  CONSTRAINT `FK_MedicoIdJornada` FOREIGN KEY (`IdJornada`) REFERENCES `jornadas` (`IdJornada`),
  CONSTRAINT `FK_MedicoPerfil` FOREIGN KEY (`IdPerfil`) REFERENCES `perfiles` (`IdPerfil`)
);


CREATE TABLE `turnos` (
  `IdTurnos` int NOT NULL AUTO_INCREMENT,
  `IdMedico` int DEFAULT NULL,
  `IdPaciente` int DEFAULT NULL,
  `IdEspecialidad` int DEFAULT NULL,
  `FechaReserva` datetime NOT NULL,
  `Observacion` text NOT NULL,
  `IdSituacion` int DEFAULT NULL,
  `Hora` int DEFAULT NULL,
  `Estado` bit(1) NOT NULL,
  PRIMARY KEY (`IdTurnos`),
  KEY `FK_TurnoMedico` (`IdMedico`),
  KEY `FK_TurnoPaciente` (`IdPaciente`),
  KEY `FK_TurnoEspecialidad` (`IdEspecialidad`),
  CONSTRAINT `FK_TurnoEspecialidad` FOREIGN KEY (`IdEspecialidad`) REFERENCES `especialidades` (`IdEspecialidad`),
  CONSTRAINT `FK_TurnoMedico` FOREIGN KEY (`IdMedico`) REFERENCES `medicos` (`Id`),
  CONSTRAINT `FK_TurnoPaciente` FOREIGN KEY (`IdPaciente`) REFERENCES `pacientes` (`Id`)
);





-- Insertar perfil de ADMIN
INSERT INTO clinica_medica.Perfiles (Descripcion, Estado)
VALUES ('Administrador', 1);

-- Insertar perfil de médico
INSERT INTO clinica_medica.Perfiles (Descripcion, Estado)
VALUES ('Médico', 1);

-- Insertar usuario administrador
INSERT INTO clinica_medica.Usuarios (UserLogin, Password, IdPerfil)
VALUES ('admin', 'admin', 1);

-- Insertar usuario médico
INSERT INTO clinica_medica.Usuarios (UserLogin, Password, IdPerfil)
VALUES ('medico', 'medico', 2);



-- Insertar nacionalidad

INSERT INTO Nacionalidades (Nacionalidad) VALUES

    ('Argentina');



-- Insertar 4 provincias 

INSERT INTO Provincias (Provincia) VALUES

    ('Buenos Aires'),

    ('Córdoba'),

    ('Santa Fe'),

    ('Mendoza');



-- insertar 5 localidades para cada provincia



-- Insertar localidades para la provincia de Buenos Aires

INSERT INTO Localidades (Localidad, IdProvincia) VALUES

    ('La Plata', 1),

    ('Mar del Plata', 1),

    ('Bahía Blanca', 1),

    ('Quilmes', 1);



-- Insertar localidades para la provincia de Córdoba

INSERT INTO Localidades (Localidad, IdProvincia) VALUES

    ('Córdoba', 2),

    ('Villa María', 2),

    ('Río Cuarto', 2),

    ('Alta Gracia', 2);



-- Insertar localidades para la provincia de Santa Fe

INSERT INTO Localidades (Localidad, IdProvincia) VALUES

    ('Rosario', 3),

    ('Santa Fe', 3),

    ('Rafaela', 3),

    ('Venado Tuerto', 3);



-- Insertar localidades para la provincia de Mendoza

INSERT INTO Localidades (Localidad, IdProvincia) VALUES

    ('Mendoza', 4),

    ('San Rafael', 4),

    ('Godoy Cruz', 4),

    ('Luján de Cuyo', 4);




